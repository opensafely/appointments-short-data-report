version: "3.0"

expectations:
  population_size: 1000

actions:
  query:
    run: >
      sqlrunner:latest
        --output output/rows.csv
        analysis/query.sql
    outputs:
      highly_sensitive:
        rows: output/rows.csv

  wrangle:
    needs: [query]
    run: >
      python:latest
        analysis/wrangle.py
    outputs:
      moderately_sensitive:
        results: output/appointment_id_processed.csv

  query_date_range:
    run: >
      sqlrunner:latest
        --output output/date_range/rows.csv
        analysis/date_range/query.sql
    outputs:
      highly_sensitive:
        rows: output/date_range/rows.csv

  wrangle_date_range:
    needs: [query_date_range]
    run: >
      python:latest python -m analysis.date_range.wrangle
    outputs:
      moderately_sensitive:
        results: output/date_range/results.csv
