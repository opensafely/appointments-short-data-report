version: "3.0"

expectations:
  population_size: 1000

actions:
  query_distinct_values:
    run: >
      sqlrunner:latest
        --output output/distinct_values/rows.csv
        analysis/distinct_values/query.sql
    outputs:
      highly_sensitive:
        rows: output/distinct_values/rows.csv

  wrangle_distinct_values:
    needs: [query_distinct_values]
    run: >
      python:latest python -m analysis.distinct_values.wrangle
    outputs:
      moderately_sensitive:
        results: output/distinct_values/results.csv

  query_date_range:
    run: >
      sqlrunner:latest
        --output output/date_range/rows.csv
        analysis/date_range/query.sql
    outputs:
      highly_sensitive:
        rows: output/date_range/rows.csv

  wrangle_date_range:
    needs: [query_date_range]
    run: >
      python:latest python -m analysis.date_range.wrangle
    outputs:
      moderately_sensitive:
        results: output/date_range/results.csv
